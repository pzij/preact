{"version":3,"sources":["src/preact.js"],"names":["EMPTY","NO_RENDER","render","SYNC_RENDER","renderSync","DOM_RENDER","build","EMPTY_BASE","NON_DIMENSION_PROPS","split","forEach","k","slice","Array","prototype","memoize","fn","mem","hasOwnProperty","options","syncComponentUpdates","hooks","component","parent","built","c","_component","hook","appendChild","vnode","attributes","s","style","substring","styleObjToCss","className","hashToClassName","Component","constructor","_dirty","_disableRendering","nextProps","base","props","state","shouldComponentUpdate","setState","extend","triggerRender","setProps","opts","d","_render","renderQueue","add","h","name","children","rendered","p","parentNode","replaceChild","nodeName","args","sharedArr","len","length","arr","lastSimple","i","undefined","join","j","child","simple","notEmpty","isVNode","String","push","VNode","__isVNode","obj","apply","x","isSameNodeType","node","nodeType","_componentConstructor","toLowerCase","buildComponentFromVNode","dom","getNodeProps","unmountComponent","createComponentFromVNode","componentRecycler","create","console","warn","removeChild","collect","rootComponent","out","textContent","recycler","document","createTextNode","appendChildren","call","childNodes","old","getNodeAttributes","attrs","o","setAccessor","value","prev","getAccessor","keyed","t","key","getAttribute","splice","newChildren","vlen","vchild","next","insertBefore","items","itemsOffline","pending","debounceRendering","process","setTimeout","rerender","nodes","clean","normalizeName","list","pop","createElement","remove","removeAttribute","toUpperCase","components","ctor","frag","createDocumentFragment","cssText","setComplexAccessor","type","l","_listeners","addEventListener","eventProxy","setAttribute","e","normalizeEventType","getNamedItem","getAttributesAsObject","item","text","_content","str","sep","term","prop","val","jsToCss","replace"],"mappings":"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","file":"preact.js","sourceRoot":"src","sourcesContent":["const EMPTY = {};\r\nconst NO_RENDER = { render: false };\r\nconst SYNC_RENDER = { renderSync: true };\r\nconst DOM_RENDER = { build: true };\r\nconst EMPTY_BASE = '';\r\nconst NON_DIMENSION_PROPS = {};\r\n\r\n'boxFlex boxFlexGroup columnCount fillOpacity flex flexGrow flexPositive flexShrink flexNegative fontWeight lineClamp lineHeight opacity order orphans strokeOpacity widows zIndex zoom'.split(' ').forEach(k => NON_DIMENSION_PROPS[k] = true);\r\n\r\n/** @private */\r\nlet slice = Array.prototype.slice;\r\n\r\n/** @private */\r\nlet memoize = (fn, mem={}) => k => mem.hasOwnProperty(k) ? mem[k] : (mem[k] = fn(k));\r\n\r\n/** @public @object Global options */\r\nlet options = {\r\n\t/** If `true`, `prop` changes trigger synchronous component updates. */\r\n\tsyncComponentUpdates: true\r\n};\r\n\r\n/** @public @object Global hook methods */\r\nlet hooks = {};\r\n\r\n\r\n/** @public Render JSX into a `parent` Element. */\r\nexport function render(component, parent) {\r\n\tlet built = build(null, component),\r\n\t\tc = built._component;\r\n\tif (c) hook(c, 'componentWillMount');\r\n\tparent.appendChild(built);\r\n\tif (c) hook(c, 'componentDidMount');\r\n\treturn build;\r\n}\r\n\r\n\r\n/** @protected Processes all created VNodes */\r\nhooks.vnode = ({ attributes }) => {\r\n\tif (!attributes) return;\r\n\r\n\tlet s = attributes.style;\r\n\tif (s && !s.substring) {\r\n\t\tattributes.style = styleObjToCss(s);\r\n\t}\r\n\r\n\tlet c = attributes['class'];\r\n\tif (attributes.hasOwnProperty('className')) {\r\n\t\tc = attributes['class'] = attributes.className;\r\n\t\tdelete attributes.className;\r\n\t}\r\n\tif (c && !c.substring) {\r\n\t\tattributes['class'] = hashToClassName(c);\r\n\t}\r\n};\r\n\r\n\r\n/** @public Base Component, with API similar to React. */\r\nexport class Component {\r\n\tconstructor() {\r\n\t\t/** @private */\r\n\t\tthis._dirty = this._disableRendering = false;\r\n\t\t/** @public */\r\n\t\tthis.nextProps = this.base = null;\r\n\t\t/** @type {object} */\r\n\t\tthis.props = hook(this, 'getDefaultProps') || {};\r\n\t\t/** @type {object} */\r\n\t\tthis.state = hook(this, 'getInitialState') || {};\r\n\t\thook(this, 'initialize');\r\n\t}\r\n\r\n\t/** Returns a `boolean` value indicating if the component should re-render when receiving the given `props` and `state`.\r\n\t *\t@param {object} props\r\n\t *\t@param {object} state\r\n\t */\r\n\tshouldComponentUpdate(props, state) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/** Update component state by copying values from `state` to `this.state`.\r\n\t *\t@param {object} state\r\n\t */\r\n\tsetState(state) {\r\n\t\textend(this.state, state);\r\n\t\tthis.triggerRender();\r\n\t}\r\n\r\n\t/** Set `props` for the component.\r\n\t*\t@param {object} props\r\n\t*\t@param {object} [opts]\r\n\t*\t@param {object} [opts.renderSync] - If `true` and {@link options.syncComponentUpdates} is `true`, triggers synchronous rendering.\r\n\t*\t@param {object} [opts.render=true] - If `false`, no render will be triggered.\r\n\t */\r\n\tsetProps(props, opts=EMPTY) {\r\n\t\tlet d = this._disableRendering===true;\r\n\t\tthis._disableRendering = true;\r\n\t\thook(this, 'componentWillReceiveProps', props, this.props);\r\n\t\tthis.nextProps = props;\r\n\t\tthis._disableRendering = d;\r\n\t\tif (opts.renderSync===true && options.syncComponentUpdates===true) {\r\n\t\t\tthis._render();\r\n\t\t}\r\n\t\telse if (opts.render!==false) {\r\n\t\t\tthis.triggerRender();\r\n\t\t}\r\n\t}\r\n\r\n\t/** Mark component as dirty and queue up a render. */\r\n\ttriggerRender() {\r\n\t\tif (this._dirty!==true) {\r\n\t\t\tthis._dirty = true;\r\n\t\t\trenderQueue.add(this);\r\n\t\t}\r\n\t}\r\n\r\n\t/** Accepts `props` and `state`, and returns a new Virtual DOM tree to build.\r\n\t *\tVirtual DOM is generally constructed via [JSX](http://jasonformat.com/wtf-is-jsx).\r\n\t *\t@returns VNode\r\n\t */\r\n\trender(props, state) {\r\n\t\treturn h('div', { component:this.constructor.name }, props.children);\r\n\t}\r\n\r\n\t/** @private */\r\n\t_render(opts=EMPTY) {\r\n\t\tif (this._disableRendering===true) return;\r\n\r\n\t\tthis._dirty = false;\r\n\r\n\t\tif (this.base && hook(this, 'shouldComponentUpdate', this.props, this.state)===false) {\r\n\t\t\tthis.props = this.nextProps;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.props = this.nextProps;\r\n\r\n\t\thook(this, 'componentWillUpdate');\r\n\r\n\t\tlet rendered = hook(this, 'render', this.props, this.state);\r\n\r\n\t\tif (this.base || opts.build===true) {\r\n\t\t\tlet base = build(this.base, rendered || EMPTY_BASE, this);\r\n\t\t\tif (this.base && base!==this.base) {\r\n\t\t\t\tlet p = this.base.parentNode;\r\n\t\t\t\tif (p) p.replaceChild(base, this.base);\r\n\t\t\t}\r\n\t\t\tthis.base = base;\r\n\t\t}\r\n\r\n\t\thook(this, 'componentDidUpdate');\r\n\t}\r\n}\r\n\r\n\r\n\r\n/** @public JSX/hyperscript reviver\r\n *\t@see http://jasonformat.com/wtf-is-jsx\r\n *  @example\r\n *  /** @jsx h *\\/\r\n *  import { render, h } from 'preact';\r\n *  render(<span>foo</span>, document.body);\r\n */\r\nexport function h(nodeName, attributes, ...args) {\r\n\tlet children,\r\n\t\tsharedArr = [],\r\n\t\tlen = args.length,\r\n\t\tarr, lastSimple;\r\n\tif (len) {\r\n\t\tchildren = [];\r\n\t\tfor (let i=0; i<len; i++) {\r\n\t\t\tlet p = args[i];\r\n\t\t\tif (p===null || p===undefined) continue;\r\n\t\t\tif (p.join) {\t\t\t// Array.isArray(args[i])\r\n\t\t\t\tarr = p;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tarr = sharedArr;\r\n\t\t\t\tarr[0] = p;\r\n\t\t\t}\r\n\t\t\tfor (let j=0; j<arr.length; j++) {\r\n\t\t\t\tlet child = arr[j],\r\n\t\t\t\t\tsimple = notEmpty(child) && !isVNode(child);\r\n\t\t\t\tif (simple) child = String(child);\r\n\t\t\t\tif (simple && lastSimple) {\r\n\t\t\t\t\tchildren[children.length-1] += child;\r\n\t\t\t\t}\r\n\t\t\t\telse if (notEmpty(child)) {\r\n\t\t\t\t\tchildren.push(child);\r\n\t\t\t\t}\r\n\t\t\t\tlastSimple = simple;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif (attributes && attributes.children) {\r\n\t\tdelete attributes.children;\r\n\t}\r\n\r\n\tlet p = new VNode(nodeName, attributes || undefined, children || undefined);\r\n\thook(hooks, 'vnode', p);\r\n\treturn p;\r\n}\r\n\r\n\r\n/** Virtual DOM Node */\r\nexport class VNode {\r\n\tconstructor(nodeName, attributes, children) {\r\n\t\t/** @type {string|class} */\r\n\t\tthis.nodeName = nodeName;\r\n\r\n\t\t/** @type {object<string>|undefined} */\r\n\t\tthis.attributes = attributes;\r\n\r\n\t\t/** @type {array<VNode>|undefined} */\r\n\t\tthis.children = children;\r\n\t}\r\n}\r\nVNode.prototype.__isVNode = true;\r\n\r\n\r\n/** @private Invoke a \"hook\" method with arguments if it exists. */\r\nfunction hook(obj, name, ...args) {\r\n\tlet fn = obj[name];\r\n\tif (fn && typeof fn==='function') return fn.apply(obj, args);\r\n}\r\n\r\n\r\n/** @private Fast check if an object is a VNode. */\r\nfunction isVNode(obj) {\r\n\treturn obj && obj.__isVNode===true;\r\n}\r\n\r\n\r\n/** @private Check if a value is `null` or `undefined`. */\r\nfunction notEmpty(x) {\r\n\treturn x!==null && x!==undefined;\r\n}\r\n\r\n\r\n/** @private Check if two nodes are equivalent. */\r\nfunction isSameNodeType(node, vnode) {\r\n\tif (node.nodeType===3) {\r\n\t\treturn typeof vnode==='string';\r\n\t}\r\n\tlet nodeName = vnode.nodeName;\r\n\tif (typeof nodeName==='function') return node._componentConstructor===nodeName;\r\n\treturn node.nodeName.toLowerCase()===nodeName;\r\n}\r\n\r\n\r\n/** @private Apply the component referenced by a VNode to the DOM. */\r\nfunction buildComponentFromVNode(dom, vnode) {\r\n\tlet c = dom && dom._component;\r\n\r\n\tif (c && dom._componentConstructor===vnode.nodeName) {\r\n\t\tlet props = getNodeProps(vnode);\r\n\t\tc.setProps(props, SYNC_RENDER);\r\n\t\treturn dom;\r\n\t}\r\n\telse {\r\n\t\tif (c) unmountComponent(dom, c);\r\n\t\treturn createComponentFromVNode(vnode);\r\n\t}\r\n}\r\n\r\n\r\n/** @private Instantiate and render a Component, given a VNode whose nodeName is a constructor. */\r\nfunction createComponentFromVNode(vnode) {\r\n\tlet component = componentRecycler.create(vnode.nodeName);\r\n\r\n\tlet props = getNodeProps(vnode);\r\n\tcomponent.setProps(props, NO_RENDER);\r\n\tcomponent._render(DOM_RENDER);\r\n\r\n\tlet node = component.base;\r\n\tnode._component = component;\r\n\tnode._componentConstructor = vnode.nodeName;\r\n\r\n\treturn node;\r\n}\r\n\r\n\r\n/** @private Remove a component from the DOM and recycle it. */\r\nfunction unmountComponent(dom, component) {\r\n\tconsole.warn('unmounting mismatched component', component);\r\n\r\n\tdelete dom._component;\r\n\thook(component, 'componentWillUnmount');\r\n\tlet base = component.base;\r\n\tif (base && base.parentNode) {\r\n\t\tbase.parentNode.removeChild(base);\r\n\t}\r\n\thook(component, 'componentDidUnmount');\r\n\tcomponentRecycler.collect(component);\r\n}\r\n\r\n\r\n/** @private Apply differences in a given vnode (and it's deep children) to a real DOM Node. */\r\nfunction build(dom, vnode, rootComponent) {\r\n\tlet out = dom,\r\n\t\tnodeName = vnode.nodeName;\r\n\r\n\tif (typeof nodeName==='function') {\r\n\t\treturn buildComponentFromVNode(dom, vnode);\r\n\t}\r\n\r\n\tif (typeof vnode==='string') {\r\n\t\tif (dom) {\r\n\t\t\tif (dom.nodeType===3) {\r\n\t\t\t\tdom.textContent = vnode;\r\n\t\t\t\treturn dom;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (dom.nodeType===1) recycler.collect(dom);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn document.createTextNode(vnode);\r\n\t}\r\n\r\n\tif (nodeName===null || nodeName===undefined) {\r\n\t\tnodeName = 'x-undefined-element';\r\n\t}\r\n\r\n\tif (!dom) {\r\n\t\tout = recycler.create(nodeName);\r\n\t}\r\n\telse if (dom.nodeName.toLowerCase()!==nodeName) {\r\n\t\tout = recycler.create(nodeName);\r\n\t\tappendChildren(out, slice.call(dom.childNodes));\r\n\t\t// reclaim element nodes\r\n\t\tif (dom.nodeType===1) recycler.collect(dom);\r\n\t}\r\n\telse if (dom._component && dom._component!==rootComponent) {\r\n\t\tunmountComponent(dom, dom._component);\r\n\t}\r\n\r\n\t// apply attributes\r\n\tlet old = getNodeAttributes(out) || EMPTY,\r\n\t\tattrs = vnode.attributes || EMPTY;\r\n\r\n\t// removed attributes\r\n\tif (old!==EMPTY) {\r\n\t\tfor (let name in old) {\r\n\t\t\tif (old.hasOwnProperty(name)) {\r\n\t\t\t\tlet o = attrs[name];\r\n\t\t\t\tif (o===undefined || o===null || o===false) {\r\n\t\t\t\t\tsetAccessor(out, name, null, old[name]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// new & updated attributes\r\n\tif (attrs!==EMPTY) {\r\n\t\tfor (let name in attrs) {\r\n\t\t\tif (attrs.hasOwnProperty(name)) {\r\n\t\t\t\tlet value = attrs[name];\r\n\t\t\t\tif (value!==undefined && value!==null && value!==false) {\r\n\t\t\t\t\tlet prev = getAccessor(out, name, old[name]);\r\n\t\t\t\t\tif (value!==prev) {\r\n\t\t\t\t\t\tsetAccessor(out, name, value, prev);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tlet children = slice.call(out.childNodes);\r\n\tlet keyed = {};\r\n\tfor (let i=children.length; i--; ) {\r\n\t\tlet t = children[i].nodeType;\r\n\t\tlet key;\r\n\t\tif (t===3) {\r\n\t\t\tkey = t.key;\r\n\t\t}\r\n\t\telse if (t===1) {\r\n\t\t\tkey = children[i].getAttribute('key');\r\n\t\t}\r\n\t\telse {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (key) keyed[key] = children.splice(i, 1)[0];\r\n\t}\r\n\tlet newChildren = [];\r\n\r\n\tif (vnode.children) {\r\n\t\tfor (let i=0, vlen=vnode.children.length; i<vlen; i++) {\r\n\t\t\tlet vchild = vnode.children[i];\r\n\t\t\tlet attrs = vchild.attributes;\r\n\t\t\tlet key, child;\r\n\t\t\tif (attrs) {\r\n\t\t\t\tkey = attrs.key;\r\n\t\t\t\tchild = key && keyed[key];\r\n\t\t\t}\r\n\r\n\t\t\t// attempt to pluck a node of the same type from the existing children\r\n\t\t\tif (!child) {\r\n\t\t\t\tlet len = children.length;\r\n\t\t\t\tif (children.length) {\r\n\t\t\t\t\tfor (let j=0; j<len; j++) {\r\n\t\t\t\t\t\tif (isSameNodeType(children[j], vchild)) {\r\n\t\t\t\t\t\t\tchild = children.splice(j, 1)[0];\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// morph the matched/found/created DOM child to match vchild (deep)\r\n\t\t\tnewChildren.push(build(child, vchild));\r\n\t\t}\r\n\t}\r\n\r\n\t// apply the constructed/enhanced ordered list to the parent\r\n\tfor (let i=0, len=newChildren.length; i<len; i++) {\r\n\t\t// we're intentionally re-referencing out.childNodes here as it is a live array (akin to live NodeList)\r\n\t\tif (out.childNodes[i]!==newChildren[i]) {\r\n\t\t\tlet child = newChildren[i],\r\n\t\t\t\tc = child._component,\r\n\t\t\t\tnext = out.childNodes[i+1];\r\n\t\t\tif (c) hook(c, 'componentWillMount');\r\n\t\t\tif (next) {\r\n\t\t\t\tout.insertBefore(child, next);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tout.appendChild(child);\r\n\t\t\t}\r\n\t\t\tif (c) hook(c, 'componentDidMount');\r\n\t\t}\r\n\t}\r\n\r\n\t// remove orphaned children\r\n\tfor (let i=0, len=children.length; i<len; i++) {\r\n\t\tlet child = children[i],\r\n\t\t\tc = child._component;\r\n\t\tif (c) hook(c, 'componentWillUnmount');\r\n\t\tchild.parentNode.removeChild(child);\r\n\t\tif (c) {\r\n\t\t\thook(c, 'componentDidUnmount');\r\n\t\t\tcomponentRecycler.collect(c);\r\n\t\t}\r\n\t\telse if (child.nodeType===1) {\r\n\t\t\trecycler.collect(child);\r\n\t\t}\r\n\t}\r\n\r\n\treturn out;\r\n}\r\n\r\n\r\n/** @private Managed re-rendering queue for dirty components. */\r\nlet renderQueue = {\r\n\titems: [],\r\n\titemsOffline: [],\r\n\tpending: false,\r\n\tadd(component) {\r\n\t\tif (renderQueue.items.push(component)!==1) return;\r\n\r\n\t\tlet d = hooks.debounceRendering;\r\n\t\tif (d) d(renderQueue.process);\r\n\t\telse setTimeout(renderQueue.process, 0);\r\n\t},\r\n\tprocess() {\r\n\t\tlet items = renderQueue.items,\r\n\t\t\tlen = items.length;\r\n\t\tif (!len) return;\r\n\t\trenderQueue.items = renderQueue.itemsOffline;\r\n\t\trenderQueue.items.length = 0;\r\n\t\trenderQueue.itemsOffline = items;\r\n\t\twhile (len--) {\r\n\t\t\tif (items[len]._dirty) {\r\n\t\t\t\titems[len]._render();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n\r\n/** @private @function Trigger all pending render() calls. */\r\nlet rerender = renderQueue.process\r\n\r\n\r\n/** @private DOM node pool, keyed on nodeName. */\r\nlet recycler = {\r\n\tnodes: {},\r\n\tcollect(node) {\r\n\t\trecycler.clean(node);\r\n\t\tlet name = recycler.normalizeName(node.nodeName),\r\n\t\t\tlist = recycler.nodes[name];\r\n\t\tif (list) list.push(node);\r\n\t\telse recycler.nodes[name] = [node];\r\n\t},\r\n\tcreate(nodeName) {\r\n\t\tlet name = recycler.normalizeName(nodeName),\r\n\t\t\tlist = recycler.nodes[name];\r\n\t\treturn list && list.pop() || document.createElement(nodeName);\r\n\t},\r\n\tclean(node) {\r\n\t\tnode.remove();\r\n\t\tlet len = node.attributes && node.attributes.length;\r\n\t\tif (len) for (let i=len; i--; ) {\r\n\t\t\tnode.removeAttribute(node.attributes[i].name);\r\n\t\t}\r\n\r\n\t\t// if (node.childNodes.length>0) {\r\n\t\t// \tconsole.warn(`Warning: Recycler collecting <${node.nodeName}> with ${node.childNodes.length} children.`);\r\n\t\t// \tslice.call(node.childNodes).forEach(recycler.collect);\r\n\t\t// }\r\n\t},\r\n\tnormalizeName: memoize(name => name.toUpperCase())\r\n};\r\n\r\n\r\n/** @private Retains a pool of Components for re-use, keyed on component name. */\r\nlet componentRecycler = {\r\n\tcomponents: {},\r\n\tcollect(component) {\r\n\t\tlet name = component.constructor.name;\r\n\t\tlet list = componentRecycler.components[name] || (componentRecycler.components[name] = []);\r\n\t\tlist.push(component);\r\n\t},\r\n\tcreate(ctor) {\r\n\t\tlet name = ctor.name,\r\n\t\t\tlist = componentRecycler.components[name];\r\n\t\tif (list && list.length) {\r\n\t\t\treturn list.splice(0, 1)[0];\r\n\t\t}\r\n\t\treturn new ctor();\r\n\t}\r\n};\r\n\r\n\r\n/** @private Append children to a Node.\r\n *\tUses a Document Fragment to batch when appending 2 or more children\r\n */\r\nfunction appendChildren(parent, children) {\r\n\tlet len = children.length;\r\n\tif (len<=2) {\r\n\t\tparent.appendChild(children[0]);\r\n\t\tif (len===2) parent.appendChild(children[1]);\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet frag = document.createDocumentFragment();\r\n\tfor (let i=0; i<len; i++) frag.appendChild(children[i]);\r\n\tparent.appendChild(frag);\r\n}\r\n\r\n\r\n/** @private Get the value of a rendered attribute */\r\nfunction getAccessor(node, name, value) {\r\n\tif (name==='class') return node.className;\r\n\tif (name==='style') return node.style.cssText;\r\n\treturn value;\r\n}\r\n\r\n\r\n/** @private Set a named attribute on the given Node, with special behavior for some names and event handlers.\r\n *\tIf `value` is `null`, the attribute/handler will be removed.\r\n */\r\nfunction setAccessor(node, name, value, old) {\r\n\tif (name==='class') {\r\n\t\tnode.className = value;\r\n\t}\r\n\telse if (name==='style') {\r\n\t\tnode.style.cssText = value;\r\n\t}\r\n\telse {\r\n\t\tsetComplexAccessor(node, name, value, old);\r\n\t}\r\n}\r\n\r\n\r\n/** @private For props without explicit behavior, apply to a Node as event handlers or attributes. */\r\nfunction setComplexAccessor(node, name, value, old) {\r\n\tif (name.substring(0,2)==='on') {\r\n\t\tlet type = name.substring(2).toLowerCase(),\r\n\t\t\tl = node._listeners || (node._listeners = {});\r\n\t\tif (!l[type]) node.addEventListener(type, eventProxy);\r\n\t\tl[type] = value;\r\n\t\t// @TODO automatically remove proxy event listener when no handlers are left\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet type = typeof value;\r\n\tif (value===null) {\r\n\t\tnode.removeAttribute(name);\r\n\t}\r\n\telse if (type!=='function' && type!=='object') {\r\n\t\tnode.setAttribute(name, value);\r\n\t}\r\n}\r\n\r\n\r\n/** @private Proxy an event to hooked event handlers */\r\nfunction eventProxy(e) {\r\n\tlet l = this._listeners,\r\n\t\tfn = l[normalizeEventType(e.type)];\r\n\tif (fn) return fn.call(this, hook(hooks, 'event', e) || e);\r\n}\r\n\r\n/** @private @function Normalize an event type/name to lowercase */\r\nlet normalizeEventType = memoize(type => type.toLowerCase());\r\n\r\n\r\n\r\n/** @private Get a node's attributes as a hashmap, regardless of type. */\r\nfunction getNodeAttributes(node) {\r\n\tlet list = node.attributes;\r\n\tif (!list || !list.getNamedItem) return list;\r\n\tif (list.length) return getAttributesAsObject(list);\r\n}\r\n\r\n\r\n/** @private Convert a DOM `.attributes` NamedNodeMap to a hashmap. */\r\nfunction getAttributesAsObject(list) {\r\n\tlet attrs = {};\r\n\tfor (let i=list.length; i--; ) {\r\n\t\tlet item = list[i];\r\n\t\tattrs[item.name] = item.value;\r\n\t}\r\n\treturn attrs;\r\n}\r\n\r\n\r\n/** @private Reconstruct `props` from a VNode */\r\nfunction getNodeProps(vnode) {\r\n\tlet props = extend({}, vnode.attributes);\r\n\tif (vnode.children) {\r\n\t\tprops.children = vnode.children;\r\n\t}\r\n\tif (vnode.text) {\r\n\t\tprops._content = vnode.text;\r\n\t}\r\n\treturn props;\r\n}\r\n\r\n\r\n/** @private Convert a hashmap of styles to CSSText */\r\nfunction styleObjToCss(s) {\r\n\tlet str = '',\r\n\t\tsep = ': ',\r\n\t\tterm = '; ';\r\n\tfor (let prop in s) {\r\n\t\tif (s.hasOwnProperty(prop)) {\r\n\t\t\tlet val = s[prop];\r\n\t\t\tstr += jsToCss(prop);\r\n\t\t\tstr += sep;\r\n\t\t\tstr += val;\r\n\t\t\tif (typeof val==='number' && !NON_DIMENSION_PROPS.hasOwnProperty(prop)) {\r\n\t\t\t\tstr += 'px';\r\n\t\t\t}\r\n\t\t\tstr += term;\r\n\t\t}\r\n\t}\r\n\treturn str;\r\n}\r\n\r\n\r\n/** @private Convert a hashmap of CSS classes to a space-delimited className string */\r\nfunction hashToClassName(c) {\r\n\tlet str = '';\r\n\tfor (let prop in c) {\r\n\t\tif (c[prop]) {\r\n\t\t\tif (str) str += ' ';\r\n\t\t\tstr += prop;\r\n\t\t}\r\n\t}\r\n\treturn str;\r\n}\r\n\r\n\r\n/** @private @function Convert a JavaScript camel-case CSS property name to a CSS property name */\r\nlet jsToCss = memoize( s => s.replace(/([A-Z])/,'-$1').toLowerCase() );\r\n\r\n\r\n/** @private Copy own-properties from `props` onto `obj`. Returns `obj`. */\r\nfunction extend(obj, props) {\r\n\tfor (let i in props) if (props.hasOwnProperty(i)) {\r\n\t\tobj[i] = props[i];\r\n\t}\r\n\treturn obj;\r\n}\r\n\r\n\r\nexport { options, hooks, rerender };\r\nexport default { options, hooks, render, rerender, h, Component };\r\n"]}